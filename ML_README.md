## ML эксперименты

Изначальна была предпринята попытка решать задачу классификации. Соответствующие эксперименты можно найти в ноутбуке. Но диапазон значений индекса качества воздуха от 0 до 500, а количество классов только 6. Исходя из этого задача показалась наименее интересной, так как мы можем попасть в нужный класс, но сильно ошибиться с индексом каачества воздуха.  

Поэтому было принято решать задачу регрессии.  

Перед обучением из датасета были удалены признаки, которые служили только для визуализаций: все признаки Category и координаты городов.

### Регрессия

В задаче была задействована среднеквадратичная ошибка (MSE), так как нам требуется минимизировать отклонение от действительного значения.  
Так как между целевой переменной и некоторыми признаками присутствовала линейная зависимость, решено было начать с обычной линейной регрессии по умолчанию, результаты которой следующие:  

|              | Train     | Test     | 
| ------------ | --------- | -------- | 
| MSE          | 58,55     |  64,71   | 

Качество модели неудовлетворительное, так как такая ошибка в наших предсказаниях моет сильно изменить категорию качества воздуха. Поэтому была предпринята попытка нормализовать данные, так как не у всех совпадает диапазон. Но результат остался таким же.
Lasso регрессия и Elastic Net дают результаты схожие с линейной регрессией даже после подбора гиперпараметров. Принято решение попробовать более сложные модели. 

RandomForestRegressor дает качество значительно выше без подбора гиперпараметров:  
|              | Train     | Test     | 
| ------------ | --------- | -------- | 
| MSE          | 16,12     |  19,43   |  

KNeighborsRegressor показал результат еще лучше:  
|              | Train     | Test     | 
| ------------ | --------- | -------- | 
| MSE          | 2,83      |  4,41   | 

Для каждой из моделей была применена перекрестная проверка для оценки точности (cross_val_score). Данные по каждой модели собраны и представлены в качестве box-plot:  
![cross](https://github.com/boisterous-cat/AirQualityProject/assets/93883573/0d809a84-9779-474a-b77e-189c10ef6b0e)

В качестве эксперимента были обучены модели и проведена перекрестная оценка без самого коррелированного признака - PM2.5. Результат упал ровно вдвое.
![cross2](https://github.com/boisterous-cat/AirQualityProject/assets/93883573/ebfe5603-1f9f-463c-a05c-6a5607145530)

### Вывод
В итоге была выбрана модель - KNeighborsRegressor.
